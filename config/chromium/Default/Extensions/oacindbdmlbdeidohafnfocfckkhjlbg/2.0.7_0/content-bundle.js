!function(e){function t(t){for(var r,i,c=t[0],o=t[1],u=t[2],p=0,f=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(l&&l(t);f.length;)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,c=1;c<n.length;c++){var o=n[c];0!==a[o]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={0:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window.webpackJsonp=window.webpackJsonp||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=o;s.push([137,1]),n()}({137:function(e,t,n){n(138),e.exports=n(336)},323:function(e,t,n){var r=n(324),a=n(325);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var s={insert:"head",singleton:!1},i=(r(a,s),a.locals?a.locals:{});e.exports=i},325:function(e,t,n){(t=n(326)(!1)).push([e.i,":root {\n  --pulse-color: #fffc02;\n}\n\n._pericles_inspector {\n  border: 1px solid #000;\n  background-color: rgba(102, 136, 253, 0.2) !important;\n  color: #000 !important;\n  /* opacity: 0.6; */\n}\n\nps-sen {\n  cursor: pointer;\n}\n\n._pericles_pulse,\n._pericles_pulse,\nps-sen:hover {\n  /*margin:100px; */\n  /*display: block; */\n  /*width: 22px; */\n  /*height: 22px; */\n  /*border-radius: 10%; */\n  background: var(--pulse-color);\n  opacity: 0.9;\n  cursor: pointer;\n  /* box-shadow: 0 0 0 rgba(204, 169, 44, 0.2); */\n  box-shadow: 0 0 0 rgba(255, 0, 32, 0.6);\n  -webkit-animation: pulse 2s infinite;\n  -moz-animation: pulse 2s infinite;\n  -ms-animation: pulse 2s infinite;\n  -o-animation: pulse 2s infinite;\n  animation: pulse 2s infinite;\n}\n\n/*.pulse:hover { */\n/*animation: none; */\n/*} */\n\n@-webkit-keyframes pulse {\n  0% {\n    -webkit-box-shadow: 0 0 0 0 rgba(204, 169, 44, 0.4);\n  }\n\n  70% {\n    -webkit-box-shadow: 0 0 0 1px rgba(204, 169, 44, 0);\n  }\n\n  100% {\n    -webkit-box-shadow: 0 0 0 0 rgba(204, 169, 44, 0);\n  }\n}\n\n@keyframes pulse {\n  0% {\n    -moz-box-shadow: 0 0 0 0 rgba(204, 169, 44, 0.4);\n    box-shadow: 0 0 0 0 rgba(204, 169, 44, 0.4);\n  }\n\n  70% {\n    -moz-box-shadow: 0 0 0 1px rgba(204, 169, 44, 0);\n    box-shadow: 0 0 0 1px rgba(204, 169, 44, 0);\n  }\n\n  100% {\n    -moz-box-shadow: 0 0 0 0 rgba(204, 169, 44, 0);\n    box-shadow: 0 0 0 0 rgba(204, 169, 44, 0);\n  }\n}\n",""]),e.exports=t},327:function(e,t){e.exports=function(){function e(e){var t=e.replace(/\u200B/g,""),n=String.fromCharCode(160),r=new RegExp(n,"g");return t=t.replace(r," ")}function t(e){return null==e.match("[\\wæøåÆØÅéáÉÁöÖ]")}function n(){var t,n=0,r=0,i=0,c=[],o=[],u=0,l=0,p="",f=document.getElementsByClassName("kix-paragraphrenderer");(function(){for(var e=document.getElementsByClassName("kix-cursor"),t=0;t<e.length;t++){if(!e[t].getElementsByClassName("kix-cursor-name")[0].innerText)return!0}return!1})()&&(t=function(){for(var e=document.getElementsByClassName("kix-cursor"),t=0;t<e.length;t++){if(!e[t].getElementsByClassName("kix-cursor-name")[0].innerText)return e[t].getElementsByClassName("kix-cursor-caret")[0]}throw"Could not find the users cursor"}().getBoundingClientRect());for(var h=0;h<f.length;h++)for(var d=f[h].getElementsByClassName("kix-lineview"),v=0;v<d.length;v++){for(var g="",x=d[v].getElementsByClassName("kix-selection-overlay"),m=d[v].getElementsByClassName("kix-wordhtmlgenerator-word-node"),b=0;b<m.length;b++){var w=m[b].getBoundingClientRect();if(w.left,t&&a(w,t)){var k=s(t.left-w.left,m[b],d[v]);n=l+k,r=g.length+k,i=u}var y=e(m[b].innerText);o.push({index:l,line:u,lineIndex:g.length,node:m[b],lineElement:d[v],text:y});for(var T=0;T<x.length;T++){var O=x[T],S=O.getBoundingClientRect();if(a(w,O.getBoundingClientRect())){var j=s(S.left-w.left,m[b],d[v]),P=s(S.left+S.width-w.left,m[b],d[v]);p+=y.substring(j,P)}}l+=y.length,g+=y}c.push(g),u++}return{nodes:o,text:c,selectedText:p,caret:{index:n,lineIndex:r,line:i}}}function r(e,t,n,r){return e<=r&&n<=t}function a(e,t){return e.left<=t.right&&e.right>=t.left&&e.top<=t.bottom&&e.bottom>=t.top}function s(t,n,r){for(var a=e(n.innerText),s=document.createElement("div"),i=[],c=0;c<a.length;c++){var o=document.createElement("span");o.innerText=a[c],o.style.cssText=n.style.cssText,o.style.whiteSpace="pre",i.push(o),s.appendChild(o)}r.appendChild(s);var u=0,l=-1,p=s.getBoundingClientRect();for(c=0;c<i.length;c++){var f=i[c].getBoundingClientRect(),h=f.left-p.left,d=h+f.width;-1==l&&(l=Math.abs(t-h));var v=Math.abs(t-h),g=Math.abs(t-d);v<=l&&(u=c,l=v),g<=l&&(u=c+1,l=g)}return s.remove(),u}function i(e,t,n){var r=0,a=n.text.length;return e>n.index&&(r=e-n.index),t<n.index+n.text.length&&(a=t-n.index),n.text.substring(r,a)}function c(e,t,n,r,a){var s=document.createElement("div");s.setAttribute("class","dictus_highlight_node"),s.style.position="absolute",s.style.left=e+"px",s.style.top=t+"px",s.style.width=n+"px",s.style.height=r+"px",s.style.backgroundColor="#D1E3FF",s.style.color="#D1E3FF",s.style.boxShadow="0px 0px 1px 1px #D1E3FF",a.appendChild(s)}function o(t,n,r){if(0==t)return 0;for(var a=e(n.innerText),s=document.createElement("div"),i=[],c=0;c<t;c++){var o=document.createElement("span");o.innerText=a[c],o.style.cssText=n.style.cssText,o.style.whiteSpace="pre",i.push(o),s.appendChild(o)}r.appendChild(s);var u=s.getBoundingClientRect(),l=i[t-1].getBoundingClientRect(),p=l.left+l.width-u.left;return s.remove(),p}return{getGoogleDocument:function(){return n()},findWordAtCaret:function(e){return function(e){var n=e.text[e.caret.line];if(0==n.length)return{word:"",startIndex:e.caret.index,endIndex:e.caret.index};var r=e.caret.lineIndex,a=e.caret.lineIndex;e.caret.lineIndex>=n.length&&(r=n.length-1,a=n.length-1);var s=n[r];for(t(s)&&r>0&&(s=n[--r]);!t(s)&&r>0;)s=n[--r];for(s=n[a];!t(s)&&a<n.length-1;)s=n[++a];var i=e.caret.index-e.caret.lineIndex+r,c=e.caret.index-e.caret.lineIndex+a;return{word:n.substring(r,a).trim(),startIndex:i,endIndex:c}}(e)},getText:function(e,t,n){return function(e,t,n){for(var a="",s=0;s<n.nodes.length;s++){if(r(e,t,n.nodes[s].index,n.nodes[s].index+n.nodes[s].text.length))a+=i(e,t,n.nodes[s])}return a}(e,t,n)},highlight:function(e,t,n){!function(e,t,n){for(var a=0;a<n.nodes.length;a++)if(r(e,t,n.nodes[a].index,n.nodes[a].index+n.nodes[a].text.length)){if(!i(e,t,n.nodes[a]).trim())continue;var s=n.nodes[a].lineElement.getBoundingClientRect(),u=n.nodes[a].node.getBoundingClientRect(),l=0,p=u.width;if(e>n.nodes[a].index)l=o(e-n.nodes[a].index,n.nodes[a].node,n.nodes[a].lineElement);if(t<n.nodes[a].index+n.nodes[a].text.length){n.nodes[a].index;p=o(t-n.nodes[a].index,n.nodes[a].node,n.nodes[a].lineElement)}c(u.left-s.left+l,u.top-s.top,p-l,u.height,n.nodes[a].lineElement)}}(e,t,n)},removeHighlight:function(){!function(){for(var e=document.getElementsByClassName("dictus_highlight_node");e.length>0;)e[0].remove()}()},cleanDocumentText:function(t){return e(t)}}}},336:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(3),c=(n(323),n(1)),o=n.n(c),u=[{host:"twitch.tv",tagName:"div",attr:"role",value:["log"],paragraph:{tagName:"div",attr:"class",value:"chat-line__message"}},{host:"rt.com",tagName:"div",attr:"class",value:["article"]},{host:"wikipedia.org",tagName:"div",attr:"id",value:["bodyContent"],junk:[{tagName:"table",attr:"class",value:["infobox"]},{tagName:"table",attr:"class",value:["vertical-navbox"]},{tagName:"div",attr:"role",value:["navigation"]},{tagName:"div",attr:"class",value:["reflist"]},{tagName:"div",attr:"id",value:["mw-panel"]},{tagName:"div",attr:"id",value:["mw-head"]},{tagName:"div",attr:"class",value:["thumbcaption"]},{tagName:"div",attr:"class",value:["shortdescription"]},{tagName:"div",attr:"id",value:["toc"]}]},{host:"nytimes.com",tagName:"article",attr:"id",value:["story"],junk:[{tagName:"div",attr:"id",value:["sponsor-wrapper"]},{tagName:"div",attr:"class",value:["bottom-of-article"]},{tagName:"div",attr:"id",value:["bottom-wrapper"]},{tagName:"p",attr:"itemprop",value:["author creator"]},{tagName:"div",attr:"id",value:["top-wrapper"]},{tagName:"time"},{tagName:"figure"}]},{host:"timesnewroman.ro",tagName:"div",attr:"class",value:["white-mask"],junk:[]},{host:"kmkz.ro",tagName:"div",attr:"class",value:["entry-content"],junk:[]},{host:"ziaruldeiasi.ro",tagName:"div",attr:"class",value:["articol-content"],junk:[]},{host:"digi24.ro",tagName:"div",attr:"class",value:["entry","data-app-meta","data-app-meta-article"],junk:[]},{host:"twitch.tv",tagName:"div",attr:"role",value:["log"],junk:[]},{host:"docs.google.com",tagName:"div",attr:"class",value:["kix-page-content-wrapper"],paragraph:{tagName:"div",attr:"class",value:"kix-paragraphrenderer"},junk:[]},{host:"nasa.gov",tagName:"div",attr:"class",value:["article-body"]},{host:"news.yahoo.com",tagName:"article",junk:[{tagName:"div",attr:"class",value:["caas-yvideo","caas-yvideo-rendered"]}]},{host:"pericles.alexandrucalin.me",tagName:"div",attr:"class",value:["_pericles_maintextcontent"],junk:[]}],l=n(26),p=n(27),f=n(34),h=n(52),d=n(53),v=n(31),g=function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<t.length)){e.next=7;break}return e.next=4,n(t[r],r,t);case 4:r++,e.next=1;break;case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function x(e){var t=e.innerText;return t?t.trim():""}function m(e){return e}function b(e,t){return function(e){return new Promise((function(t){setTimeout(t,e)}))}(500).then(e).then((function(n){return n&&!n.length&&t-500>0?b(e,t-500):n}))}function w(e){return e=function(e){return e.replace(/\s{2,}/g," ").trim()}(e=function(e){return e=(e=e.replace(/&nbsp;/gi," ")).replace(/[\u200c|\u200b|\u200d|\ufeff]/gi," ")}(e=function(e){return e.replace(/(\r\n|\n|\r)/gm,"")}(e)))}var k,y=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},T=function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O(P);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(a.a.mark((function e(n){var r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o()(document.body).find(t).get(),s=0;case 2:if(!(s<r.length)){e.next=8;break}return e.next=5,j(r[s]);case 5:s++,e.next=2;break;case 8:n();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(e,t,n,r){if(!(a=e.textContent,a=(a=(a=a.trim()).replace(/[&nbsp;|\s]+/gi,"")).replace(/[\u200c|\u200b|\u200d|\ufeff]+/gi,"")).length)return{index:n,senText:t,sentenceIndex:r};var a,s=window.document.createElement(P);o()(s).addClass(E+r);var i=w(e.textContent).trim(),c=(t||"").trim();if(0!==c.length&&i.length>c.length){var u=c.length,l=c.split(" "),p=l[l.length-1],f=c.indexOf(p);if(u>f&&u<f+p.length){var h=c.indexOf(p)+p.length;h!==u&&(u=h)}e.splitText(u)}return i=w(e.textContent).trim(),0===(c=c.slice(i.length)).length&&(n++,r++),e.parentNode.insertBefore(s,e),s.appendChild(e),{index:n,senText:c,sentenceIndex:r}},j=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=o()(t).text();o()(t).replaceWith(document.createTextNode(n)),e()})).catch((function(e){})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P="ps-sen",E="s",N=/(?:\s*\r?\n\s*){2,}/,I=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(f.a)(this,Object(h.a)(t).call(this))).type="htmlDoc",e.ignoreTags="sup, select, textarea, button, label, audio, video, dialog, embed, menu, nav, noframes, noscript, object, script, style, svg, aside, footer, #footer, .no-read-aloud ",e.container=null,e.document=null,e}var n,r,i,c,u,g,m,b,k;return Object(d.a)(t,e),Object(p.a)(t,[{key:"setBlock",value:function(e){this.container=e}},{key:"getTexts",value:(k=Object(s.a)(a.a.mark((function e(){var t,n=this,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"tts",e.abrupt("return",new Promise(function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.reset();case 2:t();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){return new Promise(function(){var e=Object(s.a)(a.a.mark((function e(r){var s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],e.next=3,n.parse(t);case 3:s=e.sent,i=null,0===s.length&&(i="ERR_NO_TEXT"),r({err:i,res:s});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).catch((function(e){})));case 2:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)})},{key:"parse",value:(b=Object(s.a)(a.a.mark((function e(){var t,n=this,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"tts",e.abrupt("return",new Promise((function(e){var t=n.findTextBlocks(100);if(t.reduce((function(e,t){return e+x(t).length}),0)<1e3){for(var r,a,s=(t=n.findTextBlocks(3)).map(x),i=3;i<s.length&&!r;i++){var c=n.getGaussian(s,0,i);s[i].length>c.mean+2*c.stdev&&(r=i)}for(var o=s.length-4;o>=0&&!a;o--){var u=n.getGaussian(s,o+1,s.length);s[o].length>u.mean+2*u.stdev&&(a=o+1)}(r||a)&&(t=t.slice(r||0,a))}var l=[];if(t.length)for(var p=0;p<t.length;p++)l.push.apply(l,n.findHeadingsFor(t[p],t[p-1])),l.push(t[p]);else l.push.apply(l,n.findOnlyHeadingsFor());e(l)})).then((function(e){return new Promise(function(){var r=Object(s.a)(a.a.mark((function r(s){var i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("tts"!==t){r.next=8;break}i=0;case 2:if(!(i<e.length)){r.next=8;break}return r.next=5,n.getTexts2(e[i]);case 5:i++,r.next=2;break;case 8:s(n.textsToRead);case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())})).catch((function(e){})));case 2:case"end":return e.stop()}}),e)}))),function(){return b.apply(this,arguments)})},{key:"findTextBlocks",value:function(e){var t=this,n="h1, h2, h3, h4, h5, h6, p, a[href], "+this.ignoreTags,r=function(e){return 3===e.nodeType&&e.nodeValue.trim().length>=3},a=function(t){return 1===t.nodeType&&o()(t).is("p:visible")&&x(t).length>=e},s=function(n){return t.someChildNodes(n,r)&&x(n).length>=e},i=function(e){return t.someChildNodes(e,a)},c=function e(t){var r=o()(t).children(":not("+n+")").get();return r.some(s)||r.some(i)||r.some(e)},u=function(e,t){t&&o()(e).data("read-aloud-multi-block",!0),l.push(e)},l=[];return function e(){if(o()(this).is("frame, iframe")&&this.contentDocument&&this.contentDocument.body)try{e.call(this.contentDocument.body)}catch(e){}else if(o()(this).is("dl"))u(this);else if(o()(this).is("ol, ul")){var t=o()(this).children().get();t.some(s)?u(this):t.some(i)?u(this,!0):t.some(c)&&u(this,!0)}else if(o()(this).is("tbody")){var r=o()(this).children();r.length>3||r.eq(0).children().length>3?r.get().some(c)&&u(this,!0):r.each(e)}else s(this)?u(this):i(this)?u(this,!0):o()(this).children(":not("+n+")").each(e)}.call(this.container||document.body),l.filter((function(e){return o()(e).is(":visible")&&o()(e).offset().left>=0}))}},{key:"getGaussian",value:function(e,t,n){for(var r=0,a=t;a<n;a++)r+=e[a].length;for(var s=r/(n-t),i=0,c=t;c<n;c++)i+=(e[c].length-s)*(e[c].length-s);return{mean:s,stdev:Math.sqrt(i)}}},{key:"getTexts2",value:(m=Object(s.a)(a.a.mark((function e(t){var n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(a.a.mark((function e(r){var s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o()(t).find(":visible").filter(n.dontRead).hide(),!o()(t).data("read-aloud-multi-block")){e.next=12;break}i=o()(t).children(":visible").get(),c=0;case 4:if(!(c<i.length)){e.next=10;break}return e.next=7,n.traverseDOM(i[c]);case 7:c++,e.next=4;break;case 10:e.next=14;break;case 12:return e.next=14,n.traverseDOM(t);case 14:o()(t).find(".read-aloud-numbering").remove(),s.show(),r();case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){})));case 1:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"skipNode",value:function(e){return!e.tagName||["figure"].includes(e.tagName.toLocaleLowerCase())}},{key:"traverseDOM",value:(g=Object(s.a)(a.a.mark((function e(t){var n,r,s,i,c,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o()(t).contents(),e.prev=1,3===t.nodeType||!this.skipNode(t)&&"none"!==o()(t).css("display")&&"hidden"!==o()(t).css("visibility")){e.next=5;break}return e.abrupt("return");case 5:if(0!==n.length){e.next=15;break}if(3!==t.nodeType||!t.nodeValue.trim()){e.next=12;break}if((r=Object(v.a)(w(t.nodeValue)).sentences().data()).length>0)if(r.length>1)for(s=this.setParagraph(t),i=0;i<r.length;i++)c=this.setSentenceInParagraph(r[i].text+" "),s.appendChild(c),this.visitNode(c),this.sentenceIndex++;else u=this.setSentence(t),this.visitNode(u),this.sentenceIndex++;return e.abrupt("return");case 12:return e.abrupt("return");case 13:e.next=27;break;case 15:if("P"!==o()(t).get(0).nodeName){e.next=20;break}return e.next=18,this.processSentencesInParagraphs(t);case 18:e.next=27;break;case 20:l=0;case 21:if(!(l<n.length)){e.next=27;break}return e.next=24,this.traverseDOM(n[l]);case 24:l++,e.next=21;break;case 27:e.next=33;break;case 29:return e.prev=29,e.t0=e.catch(1),e.abrupt("return");case 33:case"end":return e.stop()}}),e,this,[[1,29]])}))),function(e){return g.apply(this,arguments)})},{key:"processSentencesInParagraphs",value:(u=Object(s.a)(a.a.mark((function e(t){var n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve().then(Object(s.a)(a.a.mark((function e(){var r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o()(t).clone().children("sup").detach().end().text(),(s=w(r).trim()).length){e.next=4;break}return e.abrupt("return");case 4:return i=Object(v.a)(s).sentences().data().map((function(e){return e.text.trim()})),e.prev=5,e.next=8,n.setSentences(t,i,n.sentenceIndex);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5);case 13:n.addSentencesToTextToRead(i);case 14:case"end":return e.stop()}}),e,null,[[5,10]])})))).catch((function(e){})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"addSentencesToTextToRead",value:function(e){for(var t=0;t<e.length;t++)this.textsToRead.push({text:e[t]})}},{key:"setSentences",value:(c=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=this.createDeepCopy(n),s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),i=0,this.sentenceIndex;c=s.nextNode();)if(![c.parentNode.tagName,c.parentNode.parentNode.tagName].includes("SUP"))try{o=S(c,r[i],i,this.sentenceIndex),r[i]=o.senText,i=o.index,this.sentenceIndex=o.sentenceIndex}catch(e){}case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"createDeepCopy",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}},{key:"setSentencesHelper2",value:(i=Object(s.a)(a.a.mark((function e(t,n,r){var s,i,c,u,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r,i=document.createElement("ps-sen"),o()(i).addClass("s"+this.sentenceIndex),n[s]){e.next=5;break}return e.abrupt("return",s);case 5:if(c=n[s].trim(),u=w(t.textContent).trim()){e.next=9;break}return e.abrupt("return",s);case 9:if(!(u.length>c.length)){e.next=22;break}return e.next=12,this.findIndexOfSentence(t,c);case 12:l=e.sent,(p=t.nodeValue.match(/^\s+|\s$/g))&&(l-=p.length),t.splitText(l),o()(t).wrap(i),n[s]=c.substring(w(o()(t).text()).trim().length),s++,this.sentenceIndex++,e.next=23;break;case 22:0===c.indexOf(u)&&(o()(t).wrap(i),n[s]=c.substring(u.length).trim(),n[s]||(s++,this.sentenceIndex++));case 23:return e.abrupt("return",s);case 24:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"findIndexOfSentence",value:(r=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){for(var r=n.split(" ").length,a=o()(t).text().split(" "),s=0,i=0;r>0&&s<a.length;){for(i++;!a[s]||!a[s].trim();)s++,i++;i+=a[s].length,s++,r--}e(i)})).catch((function(e){})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"setWords",value:(n=Object(s.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{!function(){for(var e,a,s,i,c=0,u=n.split(" "),l=0;l<t.length;l++)s=o()(t[l]),i=o()(s).text().split(" "),o()(s).empty(),o.a.each(i,(function(t,n){(e=w(n).trim())&&(0===u[c].indexOf(e)?(a=document.createElement("ps-wor"),o()(a).addClass("s"+r+"w"+c),o()(a).text(e),o()(s).append(a),u[c]=u[c].substring(e.length),u[c]||c++):o()(s).append(document.createTextNode(e))),t<i.length-1&&o()(s).append(document.createTextNode(" "))}))}()}catch(e){}case 1:case"end":return e.stop()}}),e)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"setParagraph",value:function(e){var t=document.createElement("ps-par");return o()(e).replaceWith(t),t}},{key:"setSentence",value:function(e){var t=document.createElement("ps-sen");return o()(t).addClass("s"+this.sentenceIndex),t.appendChild(document.createTextNode(e.nodeValue)),o()(e).replaceWith(t),t}},{key:"setSentenceInParagraph",value:function(e){var t=document.createElement("ps-sen");return o()(t).addClass("s"+this.sentenceIndex),t.appendChild(document.createTextNode(e)),t}},{key:"visitNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=o()(e).first().text();n.trim()&&this.setHtmlForHighlight(o()(e).first(),t)}},{key:"setHtmlForHighlight",value:function(e,t){var n=w(o()(e).text());n&&n.length&&(this.textsToRead[this.sentenceIndex]={},this.textsToRead[this.sentenceIndex].text=n)}},{key:"addNumbering",value:function(){var e=this,t=o()(this).children(),n=t.length?x(t.get(0)):null;n&&!n.match(/^[(]?(\d|[a-zA-Z][).])/)&&t.each((function(t){o()("<span>").addClass("read-aloud-numbering").text(t+1+". ").prependTo(e)}))}},{key:"dontRead",value:function(){var e=o()(this).css("float"),t=o()(this).css("position");return o()(this).is(this.ignoreTags)||o()(this).is("sup")||"right"===e||"fixed"===t}},{key:"getText",value:function(e){return this.addMissingPunctuation(e.innerText).trim()}},{key:"addMissingPunctuation",value:function(e){return e.replace(/(\w)(\s*?\r?\n)/g,"$1.$2")}},{key:"findOnlyHeadingsFor",value:function(){var e=o()("body").find("h1, h2, h3, h4, h5, h6"),t=[];return e.each((function(e,n){n.textContent.trim().length&&t.push(n)})),t}},{key:"findHeadingsFor",value:function(e,t){for(var n=[],r=o()(e).find("h1, h2, h3, h4, h5, h6, p").filter(":visible").get(0),a=this.getHeadingLevel(r),s=this.previousNode(e,!0);s&&s!==t;){var i=o()(s).is(this.ignoreTags);if(!i&&1===s.nodeType&&o()(s).is(":visible")){var c=this.getHeadingLevel(s);c<a&&(n.push(s),a=c)}s=this.previousNode(s,i)}return n.reverse()}},{key:"getHeadingLevel",value:function(e){var t=e&&/^H(\d)$/i.exec(e.tagName);return t?Number(t[1]):100}},{key:"previousNode",value:function(e,t){return o()(e).is("body")?null:1===e.nodeType&&!t&&e.lastChild?e.lastChild:e.previousSibling?e.previousSibling:this.previousNode(e.parentNode,!0)}},{key:"someChildNodes",value:function(e,t){for(var n=e.firstChild;n;){if(t(n))return!0;n=n.nextSibling}return!1}},{key:"flatten",value:function(e){return[].concat.apply([],e)}},{key:"getTextsOnly",value:function(e){var t=o()(e).find(":visible").filter(this.dontRead).hide();o()(e).find("ol, ul").addBack("ol, ul").each(this.addNumbering);var n=o()(e).data("read-aloud-multi-block")?o()(e).children(":visible").get().map(this.getText):this.getText(e).split(N);return o()(e).find(".read-aloud-numbering").remove(),t.show(),n}}]),t}(function(){function e(){Object(l.a)(this,e),this.textsToRead=[],this.sentenceIndex=0}var t;return Object(p.a)(e,[{key:"reset",value:(t=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.textsToRead=[],this.sentenceIndex=0,e.next=4,T();case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()),R=n(51),C=function(){function e(){Object(l.a)(this,e),this._page=null,this.textsToRead=[],this.sentenceIndex=0}var t;return Object(p.a)(e,[{key:"reset",value:(t=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.textsToRead=[],this.sentenceIndex=0,o()(this.viewport).stop(),e.next=5,T();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pages",get:function(){return Array.from(document.querySelectorAll(this.pageIdent))}},{key:"pageIndex",get:function(){return e=this.pages,t=this.viewport,-1===(n=e.findIndex((function(e){return e.offsetTop+e.offsetHeight/2>t.scrollTop})))?e.length-1:n;var e,t,n}},{key:"page",get:function(){return this._page},set:function(e){this._page=e}},{key:"nextPage",get:function(){return this._page.nextSibling}},{key:"viewport",get:function(){return document.querySelector(this.viewportIdent)}}]),e}(),_=null,A=function(e){function t(){var e;return Object(l.a)(this,t),e=Object(f.a)(this,Object(h.a)(t).call(this)),_||(_=Object(R.a)(e)),e.type="googleDoc",e.pageIdent=".kix-page",e.paraIdent=".kix-paragraphrenderer",e.viewportIdent=".kix-appview-editor",Object(f.a)(e,_)}var n,r,i,c,u,g;return Object(d.a)(t,e),Object(p.a)(t,[{key:"getTexts",value:(g=Object(s.a)(a.a.mark((function e(){var t,n=this,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"tts",e.abrupt("return",new Promise(function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.reset();case 2:t();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){return new Promise(function(){var e=Object(s.a)(a.a.mark((function e(r){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],e.t0=s,e.next=4,n.getTextsOfPage(n.pageIndex,t);case 4:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),r(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).then((function(e){return Promise.all(e)})).then((function(){return new Promise((function(e){var r=null;"tts"!==t&&0===n.textsToRead.length&&(r="ERR_NO_TEXT"),e({err:r,res:n.textsToRead})}))})).catch((function(e){})));case 2:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)})},{key:"getTextsOfPage",value:(u=Object(s.a)(a.a.mark((function e(t){var n,r,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:"tts",e.prev=1,this.page=this.pages[t],!this.page){e.next=9;break}return r=this.viewport.scrollTop,this.viewport.scrollTop=o()(this.page).position().top,e.next=8,this.processSentencesInParagraphs(this.page,n);case 8:this.viewport.scrollTop=r;case 9:return e.abrupt("return",!0);case 12:e.prev=12,e.t0=e.catch(1);case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(e){return u.apply(this,arguments)})},{key:"processSentencesInParagraphs",value:(c=Object(s.a)(a.a.mark((function e(t){var n,r=this,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"tts",e.abrupt("return",Promise.resolve().then(Object(s.a)(a.a.mark((function e(){var s,i,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=o()(t).find(".kix-paragraphrenderer").get(),i=0;case 3:if(!(i<s.length)){e.next=18;break}if(c=w(o()(s[i]).text()).trim(),"tts"!==n){e.next=14;break}return u=Object(v.a)(c).sentences().data().map((function(e){return e.text.trim()})),e.next=11,r.setSentences(s[i],u,r.sentenceIndex);case 11:r.addSentencesToTextToRead(u),e.next=15;break;case 14:r.addSentencesToTextToRead([c]);case 15:i++,e.next=3;break;case 18:case"end":return e.stop()}}),e)})))).catch((function(e){})));case 2:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"addSentencesToTextToRead",value:function(e){for(var t=0;t<e.length;t++)e[t]&&this.textsToRead.push({text:e[t]})}},{key:"setSentences",value:(i=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,o,u,l,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=y(n),s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),i=this.sentenceIndex,u=0,l={};c=s.nextNode();)l=S(c,r[u],u,this.sentenceIndex),r[u]=l.senText,u=l.index,this.sentenceIndex=l.sentenceIndex;p=0;case 7:if(!(p<n.length)){e.next=16;break}return o=E+i,f=t.getElementsByClassName(o),e.next=12,this.setWords(f,n[p],i);case 12:i++;case 13:p++,e.next=7;break;case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"setWords",value:(r=Object(s.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"setSentencesHelper2",value:(n=Object(s.a)(a.a.mark((function e(t,n,r){var s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=document.createElement(P),o()(s).addClass(E+this.sentenceIndex),n[r]){e.next=4;break}return e.abrupt("return",r);case 4:if(i=n[r].trim(),c=w(o()(t).text()).trim()){e.next=8;break}return e.abrupt("return",r);case 8:return c.length>i.length?(o()(t).wrap(s),n[r]=i.substring(w(o()(t).text()).trim().length),r++,this.sentenceIndex++):0===i.indexOf(c)&&(o()(t).wrap(s),n[r]=i.substring(c.length).trim(),n[r]||(r++,this.sentenceIndex++)),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"findIndexOfSentence",value:function(e,t){return new Promise((function(n){for(var r=t.split(" ").length,a=o()(e).text().split(" "),s=0,i=0;r>0&&s<a.length;){for(i++;!a[s]||!a[s].trim();)s++,i++;i+=a[s].length,s++,r--}n(i)})).catch((function(e){}))}},{key:"setSentence",value:function(e,t){try{t.split(" ");for(var n,r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);n=r.nextNode();){var a=document.createElement(P);o()(a).addClass(E+this.sentenceIndex),o()(n).wrap(a)}}catch(e){}}}]),t}(C),B=function(){var e=this,t=[],n=0,r=o()(".drive-viewer-paginated-scrollable").get(0),c=o()(".drive-viewer-paginated-page");function u(e){return new Promise((function(a){var s=c.get(e);if(s){var i=r.scrollTop;return r.scrollTop=o()(s).position().top,tryGetTexts(p.bind(s),3e3).then((function(e){r.scrollTop=i;for(var s=0;s<e.length;s++)t[n]={},t[n].text=e[s],n++;a(e)}))}a([])})).catch((function(e){}))}function l(){return Promise.resolve().then((function(){t=[],n=0})).catch((function(e){}))}function p(){var e=o()("p",this).get().map(getInnerText).filter(isNotEmpty);return fixParagraphs(e)}this.reset=Object(s.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:e.container=!1;case 3:case"end":return t.stop()}}),t)}))),this.getCurrentIndex=function(){for(var e=0;e<c.length&&!(c.eq(e).position().top>r.scrollTop+o()(r).height()/2);e++);return i-1},this.getTexts=function(){return new Promise(function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:t();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){return new Promise((function(e){for(var t=[],n=0;n<c.length;n++)t.push(u(n));e(t)}))})).then((function(e){return Promise.all(e)})).then((function(){return new Promise((function(e){var n=null;0===t.length&&(n="ERR_NO_TEXT"),e({err:n,res:t})}))})).catch((function(e){}))}},D=function(){this.type="googleDrivePreview";var e,t,n=[],r=0;function i(){var n=o()("[role=document]:visible").eq(0);e=n.parent().get(0),t=n.children().slice(n.children().first().is("[role=button]")?2:1);for(var r=0,a=0;a<t.length;a++)if(t.eq(a).position().top>e.scrollTop+o()(e).height()/2){r=a;break}return r-1}function c(){return u.apply(this,arguments)}function u(){return(u=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,l(P);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})))).apply(this,arguments)}function l(e){return new Promise(function(){var t=Object(s.a)(a.a.mark((function t(n){var r,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=o()(document.body).find(e).get(),s=0;case 2:if(!(s<r.length)){t.next=8;break}return t.next=5,p(r[s]);case 5:s++,t.next=2;break;case 8:n();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function p(e){return new Promise((function(t){var n=o()(e).text();o()(e).replaceWith(document.createTextNode(n)),t()})).catch((function(e){}))}function f(){return Promise.resolve().then((function(){n=[],0})).catch((function(e){}))}function h(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tts",i=t.get(n);return new Promise((function(t){if(i){var n=e.scrollTop;return e.scrollTop=o()(i).position().top,b(w.bind(i),3e3).then((function(a){if(e.scrollTop=n,"tts"===r){var s=d(a);g(s),t(s)}else g(a),t(a)}))}t([])})).then(function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){}))}function d(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=Object(v.a)(r).sentences().data().map((function(e){return e.text.trim()}));t=t.concat(a)}return t}function g(e){for(var t=0;t<e.length;t++)e[t]&&n.push({text:e[t]})}function w(){return function(e){for(var t=[],n="",r=0;r<e.length;r++)e[r]?(n&&(/-$/.test(n)?n=n.substr(0,n.length-1):n+=" "),n+=e[r].replace(/-\r?\n/g,""),e[r].match(/[.!?:)"'\u2019\u201d]$/)&&(t.push(n),n="")):n&&(t.push(n),n="");return n&&t.push(n),t}(o()("p",this).get().map(x).filter(m))}this.reset=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,f();case 3:return e.next=5,c();case 5:case"end":return e.stop()}}),e)}))),this.scrollToAdjacentPage=function(n){return new Promise((function(a){var s=null;"next"===n?r<t.length-1&&-1!==r?s=t[r+1]:a("ERR"):r>0?s=t[r-1]:-1===r?s=t[t.length-2]:a("ERR"),e.scrollTop=o()(s).position().top,a()})).catch((function(e){}))},this.getTexts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tts";return r=i(),new Promise(function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return e.next=4,c();case 4:t();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){return new Promise(function(){var t=Object(s.a)(a.a.mark((function t(n){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=[],t.t0=s,t.next=4,h(r,e);case 4:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),n(s);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){}))})).then((function(e){return Promise.all(e).catch((function(e){}))})).then((function(){return new Promise((function(t){var r=null;"tts"!==e&&0===n.length&&(r="ERR_NO_TEXT"),t({err:r,res:n})}))})).catch((function(e){}))}},L=(n(327),null),H=function(e){function t(){var e;return Object(l.a)(this,t),e=Object(f.a)(this,Object(h.a)(t).call(this)),L||(L=Object(R.a)(e)),e.type="viewerDoc",e.pageIdent=".page",e.paraIdent=".textLayer",e.viewportIdent="#canvasContainer",Object(f.a)(e,L)}var n,r,i,c;return Object(d.a)(t,e),Object(p.a)(t,[{key:"getTexts",value:(c=Object(s.a)(a.a.mark((function e(){var t,n=this,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:"tts",e.abrupt("return",new Promise(function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.reset();case 2:t();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){return new Promise(function(){var e=Object(s.a)(a.a.mark((function e(r){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],e.t0=s,e.next=4,n.getTextsOfPage(n.pageIndex,t);case 4:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),r(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).then((function(e){return Promise.all(e)})).then((function(){return new Promise((function(e){var r=null;"tts"!==t&&0===n.textsToRead.length&&(r="ERR_NO_TEXT"),e({err:r,res:n.textsToRead})}))})).catch((function(e){})));case 2:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"getTextsOfPage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tts";return new Promise(function(){var r=Object(s.a)(a.a.mark((function r(s){var i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.page=t.pages[e],!t.page){r.next=8;break}return i=t.viewport.scrollTop,t.viewport.scrollTop=t.page.offsetTop,r.next=7,t.processSentencesInParagraphs(t.page,n);case 7:t.viewport.scrollTop=i;case 8:s();case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){}))}},{key:"processSentencesInParagraphs",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Promise.resolve().then(Object(s.a)(a.a.mark((function n(){var r,i,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.querySelectorAll(t.paraIdent),i="",!1,n.next=5,g(r,function(){var e=Object(s.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=w(n.textContent).trim(),c=Object(v.a)(i).sentences().data().map((function(e){return e.text.trim()})),e.next=5,t.setSentences(n,c);case 5:t.addSentencesToTextToRead(c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return n.stop()}}),n)})))).catch((function(e){}))}},{key:"addSentencesToTextToRead",value:function(e){for(var t=0;t<e.length;t++)e[t]&&this.textsToRead.push({text:e[t]})}},{key:"setSentences",value:(i=Object(s.a)(a.a.mark((function e(t,n,r){var s,i,c,o,u,l,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r&&(r=!0),s=y(n),i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),c=0,o=this.sentenceIndex;case 5:if(!(u=i.nextNode())){e.next=17;break}return e.prev=6,e.next=9,this.setSentencesHelper(u,s,c,r);case 9:c=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6);case 15:e.next=5;break;case 17:p=0;case 18:if(!(p<n.length)){e.next=27;break}return l=E+o,f=t.getElementsByClassName(l),e.next=23,this.setWords(f,n[p],o);case 23:o++;case 24:p++,e.next=18;break;case 27:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"setWords",value:(r=Object(s.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{!function(){for(var e=0,a=n.split(" "),s=function(n){var s=o()(t[n]),i=o()(s).text().split(" ");o()(s).empty(),o.a.each(i,(function(t,n){var c=w(n).trim();if(c){var u=a[e];if(u&&0===u.indexOf(c)){var l=document.createElement("ps-wor");o()(l).addClass(E+r+"w"+e),o()(l).text(c),o()(s).append(l),a[e]=a[e].substring(c.length),a[e]||e++}else o()(s).append(document.createTextNode(c))}t<i.length-1&&o()(s).append(document.createTextNode(" "))}))},i=0;i<t.length;i++)s(i)}()}catch(e){}case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"setSentencesHelper",value:(n=Object(s.a)(a.a.mark((function e(t,n,r,s){var i,c,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=document.createElement(P),o()(i).addClass(E+this.sentenceIndex),n[r]){e.next=4;break}return e.abrupt("return",r);case 4:if(c=n[r].trim(),u=w(o()(t).text()).trim()){e.next=8;break}return e.abrupt("return",r);case 8:if(!(u.length>c.length)){e.next=18;break}return e.next=11,this.findIndexOfSentence(t,c);case 11:l=e.sent,t.splitText(l),o()(t).wrap(i),n[r]=c.substring(w(o()(t).text()).trim().length),s&&(r++,this.sentenceIndex++),e.next=19;break;case 18:0===c.indexOf(u)&&(o()(t).wrap(i),n[r]=c.substring(u.length).trim(),n[r]||s&&(r++,this.sentenceIndex++));case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,r,a){return n.apply(this,arguments)})},{key:"findIndexOfSentence",value:function(e,t){return new Promise((function(n){for(var r=t.split(" ").length,a=o()(e).text().split(" "),s=0,i=0;r>0&&s<a.length;){for(i++;!a[s]||!a[s].trim();)s++,i++;i+=a[s].length,s++,r--}n(i)})).catch((function(e){}))}}]),t}(C),M={parser:{},getParserByUrl:function(){var e=[{parser:A,check:"docs.google.com"===window.location.hostname},{parser:B,cond:[o()(".drive-viewer-paginated-scrollable").length,"docs.google.com"===window.location.hostname]},{parser:D,cond:[!o()(".drive-viewer-paginated-scrollable").length,"docs.google.com"===window.location.hostname]},{parser:H,check:-1!==window.location.href.indexOf("ViewerJS")},{parser:I,check:!0}].find((function(e){return"object"==typeof e.check?!!e.every((function(e){return!0===e})):!!e.check}));return M.parser=new e.parser,M.parser},filterSpecialSite:function(e){return u.filter((function(t){return-1!==e.indexOf(t.host)}))[0]},specialSite:function(e){return M.filterSpecialSite(e)},specialSiteGetBlock:function(e){var t;return t="id"===e.attr?"".concat(e.tagName,"#").concat(e.value.join(" ")):"class"===e.attr?"".concat(e.tagName,".").concat(e.value.join(" ")):e.attr&&e.value?"".concat(e.tagName,"[").concat(e.attr,'="').concat(e.value.join(" "),'"]'):"".concat(e.tagName),o()(t)},specialSiteTagsToQuery:function(e){return e.map((function(e){return"".concat(e.tagName,"[").concat(e.attr,'="').concat(e.value.join(" "),'"]')})).join(", ")}},Y=M,W=new(n(136).Store),F={IS_STOPPED:0,IS_LOADING:1,IS_READY:2,IS_PLAYING:3,IS_PAUSED:4,IS_ERROR:5},G={LOADING:"PLAYER::LOADING",ERROR:"PLAYER::ERROR",UPDATE:"PLAYER::UPDATE",TAB_ID:"PLAYER::TAB_ID",SET_VOICES:"PLAYER::SET_VOICES"},U={PREV:"PLAYER::PREV",NEXT:"PLAYER::NEXT",PLAY:"PLAYER::PLAY",STOP:"PLAYER::STOP",HALT:"PLAYER::HALT",PAUSE:"PLAYER::PAUSE",RESUME:"PLAYER::RESUME"},X={SKIP_ANIMATE:"CONTENT::SKIP_ANIMATE"},V={SET_SECTIONS:"PARSER::SET_SECTIONS",GET_SECTIONS:"PARSER::GET_SECTIONS"},q=chrome||browser,z=function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var a={};a.message=t,void 0!==n&&(a.params=n),q.runtime.sendMessage(a,(function(t){e(t)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(e){var t="ps-sen.s".concat(e);return o()(t).last()},K=function(e,t){return clearTimeout(k),o()(t).stop(),new Promise((function(n){t.scrollTop=e.offsetTop,n("next")})).catch((function(e){}))},J=function(){var e=Object(s.a)(a.a.mark((function e(t,n,r){var s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearTimeout(k);try{s=$(t).parent(),n=n||window.document.documentElement||window.document.body,s.length&&(i=o()(n),c=r?Math.round(r.offsetTop+s[0].parentNode.offsetTop):s.offset().top,c=Math.round(c),i.stop(),k=setTimeout((function(){i.animate({scrollTop:c-200},1200)}),1e3))}catch(e){}return e.abrupt("return",Promise.resolve());case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Q=function(){o()("ps-sen").removeClass("_pericles_pulse")},Z=function(e){Q(),o()('ps-sen[class="s'.concat(e,'"]')).addClass("_pericles_pulse")},ee=chrome||browser,te={},ne=Y.getParserByUrl(),re=Y.specialSite(window.location.host);if(re&&re.junk){var ae=Y.specialSiteGetBlock(re);ae&&ne.setBlock&&ne.setBlock(ae)}o()(document).on("click","ps-sen",Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Number(o()(this).attr("class").match(/s([0-9]+)/)[1]),W.dispatch({type:U.HALT}),W.dispatch({type:G.UPDATE,status:F.IS_READY,currentSection:t}),W.dispatch({type:X.SKIP_ANIMATE,value:!0}),setTimeout((function(){W.dispatch({type:U.PLAY})}),100);case 6:case"end":return e.stop()}}),e,this)})))),te.getSections=Object(s.a)(a.a.mark((function e(){var t,n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=Y.specialSite(window.location.host))&&t.junk&&(n=Y.specialSiteGetBlock(t))&&ne.setBlock&&ne.setBlock(n),ee.runtime.sendMessage({type:"event",data:"visited",action:window.location.host,url:window.location.href}),r=function(){W.dispatch({type:G.UPDATE,status:F.IS_ERROR})},s=!1,e.prev=7,e.next=10,ne.getTexts();case 10:s=e.sent,e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(7),r(),new Error("Could not retrive sections",e.t0);case 18:if(s&&!s.err&&s.res){e.next=21;break}throw r(),new Error("Could not retrive sections");case 21:return i=[],s.res.forEach((function(e){e&&i.push(e)})),W.dispatch({type:V.SET_SECTIONS,value:i}),W.dispatch({type:U.PLAY}),te.highlightSentence(0),te.scrollToSection(0),e.abrupt("return",!0);case 30:case"end":return e.stop()}}),e,null,[[7,14]])}))),te.reset=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,ne.reset();case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error("could not reset webParser");case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,null,[[1,6]])}))),te.highlightColor=function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=W.getState(),t||(t="#"+(n.highlightColor||"fffc02")),t+="40",document.documentElement.style.setProperty("--pulse-color",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te.highlightSentence=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Z(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te.webParserType=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ne.type);case 2:case"end":return e.stop()}}),e)}))),te.scrollToAdjacentPage=Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(ne.nextPage,ne.viewport);case 2:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),te.unHighlightSentence=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Q());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te.scrollToSection=function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===W.getState().autoscroll){e.next=5;break}return e.abrupt("return",!0);case 5:if("viewerDoc"!==ne.type){e.next=10;break}return e.next=8,J(t,ne.viewport,ne.page);case 8:e.next=17;break;case 10:if("googleDoc"!==ne.type){e.next=15;break}return e.next=13,J(t,ne.viewport);case 13:e.next=17;break;case 15:return e.next=17,J(t);case 17:return e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.highlightColor();case 2:case"end":return e.stop()}}),e)})))(),window.addEventListener("beforeunload",Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z("tabClosed");case 2:case"end":return e.stop()}}),e)}))));var se={currentSection:0,status:0};W.subscribe(Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=W.getState()).player.currentSection!==se.currentSection&&t.player.status===F.IS_PLAYING&&(se.currentSection=t.player.currentSection,te.highlightSentence(t.player.currentSection),t.skipAnimate?W.dispatch({type:X.SKIP_ANIMATE,value:!1}):te.scrollToSection(t.player.currentSection)),se.status===t.player.status||t.player.status!==F.IS_STOPPED){e.next=7;break}return e.next=7,te.reset();case 7:se.status=t.player.status;case 8:case"end":return e.stop()}}),e)})))),ee.runtime.onMessage.addListener(function(){var e=Object(s.a)(a.a.mark((function e(t,n,r){var s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,s=te[t.message],e.next=5,s.call(null,t.params);case 5:i=e.sent,r(i),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),r("error");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n,r){return e.apply(this,arguments)}}());var ie,ce={play:function(){W.dispatch({type:U.PLAY})},stop:function(){W.dispatch({type:U.STOP})},next:function(){W.dispatch({type:U.NEXT})},prev:function(){W.dispatch({type:U.PREV})}};document.addEventListener("keyup",(function(e){clearTimeout(ie),ie=setTimeout((function(){var t=W.getState(),n=Object.keys(t.hotkeys).find((function(n){return t.hotkeys[n][0].which===e.which}));!t.disableHotkeys&&t.player.status!==F.IS_STOPPED&&n&&ce[n]&&ce[n]()}),150)}))}});